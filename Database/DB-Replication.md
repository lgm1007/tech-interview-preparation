## DB Replication
* 데이터베이스의 **고가용성**과 **데이터 안정성**을 보장하기 위해 사용되는 핵심 기술
* 데이터의 지속적인 **가용성**과 **신뢰성**을 위해, 원본 서버와 복제 서버간의 데이터 동기화는 필수적이다.

### 바이너리 로그 저장 방식
* 레플리케이션은 원본 서버에서 발생하는 모든 데이터 변경 사항을 복제 서버로 복제하여 두 서버 간의 데이터 일관성을 유지하는 메커니즘이다.
* 위 과정은 주로 **바이너리 로그**를 기반으로 이루어지며, 바이너리 로그는 **원본 서버에서 실행된 모든 데이터 변경 쿼리를 기록**한다.
* MySQL에서 바이너리 로그를 저장하는 방식으로 **Row, Statement, Mixed** 세 가지 방식이 있다.

#### Row
* 데이터베이스의 **각 행별로 변경된 내용**을 정확히 기록하는 방식
* Row 방식은 데이터 일관성을 매우 높게 유지할 수 있다는 장점이 있다.
* 모든 행의 변경 사항을 저장하기 때문에 바이너리 로그 파일의 크기가 급격히 증가할 수 있어 저장 공간에 부담을 준다는 단점이 있다.

#### Statement
* **데이터 변경을 일으킨 SQL문 자체**를 바이너리 로그에 기록하는 방식
* 로그 파일 크기를 상대적으로 작게 유지할 수 있다는 장점이 있다.
* 실행할 때마다 다른 값을 반환하는 함수와 같이 **비확정적 SQL 쿼리**가 실행될 경우, 동일한 쿼리가 원본과 복제 서버에서 다른 결과가 도출되는 **데이터 불일치 문제**가 발생할 수 있다.

#### Mixed
* 상황에 따라 **Row 기반과 Statement 기반을 혼합**하여 로그를 기록하는 방식
* 비확정적 SQL이 아닌 경우에는 Statement 방식, 비확정적 SQL이 실행되는 경우에는 Row 방식을 사용
* 위 두 방식의 장점을 모두 활용할 수 있다는 장점이 있다.
* 구현이 다소 복잡할 수 있다는 단점이 있다.

### 복제 과정
1. 원본 서버에서 데이터 변경 쿼리가 실행되고, 선택된 로그 저장 방식에 따라 바이너리 로그에 기록
2. 복제 서버의 IO Thread가 바이너리 로그를 읽어와 복제 서버의 릴레이 로그로 전송
    * 릴레이 로그는 복제 서버에서 원본 서버의 바이너리 로그를 저장하는 임시 저장소 역할
3. 릴레이 로그에 저장된 로그를 기반으로 복제 서버의 SQL 스레드가 실제 데이터베이스에 변경 사항을 적용
